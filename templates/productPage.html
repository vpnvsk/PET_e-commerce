{% extends 'base.html' %}

{%block content%}
  <div id="main">
    <div id="content" class="left">
        
        <div class="projects">
            <h3>{{product.brand}} {{product.model_name}}</h3>
            
            <div class="item">
              <div id="myCarousel" class="carousel slide" data-ride="carousel">
                <!-- Indicators -->
              <ol class="carousel-indicators">
                <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                <li data-target="#myCarousel" data-slide-to="1"></li>
                <li data-target="#myCarousel" data-slide-to="2"></li>
              </ol>
            
                <!-- Wrapper for slides -->
              <div class="carousel-inner">
                <div class="item active">
                  <img src="{{product.images.img1.url}}"  style="width:100% ;">
                </div>
            
                <div class="item">
                  <img src="{{product.images.img2.url}}"  style="width:100%;">
                </div>
                
                <div class="item">
                  <img src="{{product.images.img3.url}}"  style="width:100%;">
                </div>
              
              </div>
            
                <!-- Left and right controls -->
              <a class="left carousel-control" href="#myCarousel" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="right carousel-control" href="#myCarousel" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right"></span>
                <span class="sr-only">Next</span>
              </a>
            </div>
               
                <div class="text left">
                    <h4>{{product.price}} </h4>
                </div>
                <div class="cl">&nbsp;</div>
                <div class  = "grid grid-cols-5 gap-0">  
                  {% for size in product_size %}
                    {% if size.get_count > 0 %}
                      <button class="bg-white text-black border border-black rounded-full py-2 px-4">{{ size.size }}</button>
                    {%else%}
                      <button class="bg-white text-black border border-black rounded-full py-2 px-4 opacity-50 cursor-not-allowed" disabled> {{ size.size }} </button>
                    {%endif%}

                  {% endfor %}
                  <form name = "form"  
                   id="register">
                    {% csrf_token %}
                    {{form}}
                    <input type="submit" value="add to cart" id="submitButton" />
                </form>
              
                  
                </div>
            </div>
           <!-- <a href="{{product.get_add_to_cart_url}}" ><button>Add to cart</button></a>-->
        </div>
    </div>
   <script src="https://code.jquery.com/jquery-3.5.1.js" 
    integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" 
      crossorigin="anonymous"></script>

<script type="text/javascript">
  
 
$('#submitButton').click(function(event){
         event.preventDefault(); //so that we stop normal form submit.
         var a = $("#id_size_field").val();
    
    $.ajax({
                    type:'POST',
                     url:'{% url "cart:add-to-cart" product.id %}',
                     data:
                     {
                        
                         "size":JSON.stringify(a),
                         csrfmiddlewaretoken:'{{csrf_token}}'
                     },
                     success:function(){
             alert('Item has been adde to your cart');
             }
       
                       })
    });
    

</script>
{%endblock%}
